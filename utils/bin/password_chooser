#!/bin/bash

# Get all password entries from pass store with full paths
# We'll use find to get the actual file paths and convert them to pass names
PASSWORD_STORE_DIR="${PASSWORD_STORE_DIR:-$HOME/.password-store}"

PASSWORD_ENTRIES=$(find "$PASSWORD_STORE_DIR" -type f -name "*.gpg" | \
    sed "s|^$PASSWORD_STORE_DIR/||" | \
    sed 's/\.gpg$//' | \
    sort)

# Use choose to select a password
CHOSEN=$(echo "$PASSWORD_ENTRIES" | ~/dotfiles/hammerspoon/bin/choose)

# If something was chosen, copy it to clipboard
if [ -n "$CHOSEN" ]; then
    pass show -c "$CHOSEN"
fi
